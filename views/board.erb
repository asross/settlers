<style type="text/css">
  <% height = 100.0 %>
  <% width = height/Math.sqrt(3) %>
  <% margin = 5 + height/4.0 %>
  body {
    margin: 0;
  }
  .tile {
    position: relative;
    width: <%= width %>px;
    height: <%= height %>px;
    margin-left: <%= margin %>px;
  }
  .tile.water {
    background-color: cornflowerblue;
  }
  .tile.wheat {
    background-color: goldenrod;
  }
  .tile.sheep {
    background-color: yellowgreen;
  }
  .tile.wood {
    background-color: forestgreen;
  }
  .tile.ore {
    background-color: darkgray;
  }
  .tile.brick {
    background-color: brown;
  }
  .tile.desert {
    background-color: wheat;
  }
  .tile.first {
    -webkit-transform: rotateZ(60deg);
  }
  .tile.second {
    -webkit-transform: rotateZ(-60deg);
    top: <%= -1*height %>px;
  }
  .tile.third {
    top: <%= -2*height %>px;
  }
  .number {
    width: <%= height/2.0 %>px;
    height: <%= height/2.0 %>px;
    line-height: <%= height %>px;
    font-size: 2em;
    position: relative;
    text-align: center;
    vertical-align: middle;
    top: <%= -3*height %>px;
    color: white;
    left: <%= height/3.0 %>px;
    background-color: transparent;
  }
  .hex {
    height: 0px;
  }
  #chat {
    position: absolute;
    top: <%= (1+@board.side_length*2)*height %>px;
    width: <%= 2*margin + 10*width %>px;
    height: 200px;
    border-top: 1px solid #ccc;
  }
  #chat #message-area {
    height: 175px;
    width: 100%;
    background-color: #eee;
  }
  #chat form input {
    width: 100%;
  }
  #players {
    position: absolute;
    left: <%= 2*margin + 10*width %>px;
    top: 0;
    height: <%= 200 + (1+@board.side_length*2)*height %>px;
    border-left: 1px solid #ccc;
    width: 500px;
  }

  <% @board.hexes.flatten.each do |hex| %>
    <%= "#h#{hex.x}-#{hex.y}" %> {
      position: absolute;
      top: <%= hex.y*height + (hex.x-@board.side_length)*(height/2.0) %>px;
      left: <%= hex.x*height*Math.sqrt(3)/2.0 %>px;
    }
  <% end %>
</style>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
      $('.tile, .number').click(function() {
        console.log($(this).closest('.hex').attr('id'));
      });
  });
</script>

<div id='players'>
</div>

<% @board.hexes.flatten.each do |hex| %>
  <% next if hex.x + hex.y < @board.side_length %>
  <% next if hex.x + hex.y > 3*@board.side_length %>
  <%= erb :hex, layout: false, locals: { hex: hex } %>
<% end %>

<div id='chat'>
  <div id='message-area'></div>
  <form action='/messages'>
    <input type='text' placeholder='message...'>
  </form>
</div>
